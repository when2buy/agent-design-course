---
title: "第一阶段：基础循环与工具 (s01 - s03)"
excerpt: "介绍智能体的底层基石：核心循环、工具调度机制以及任务规划。"
isPremium: false
order: 1
readingTime: 6
tags: ["claude-code", "agent", "stage1", "tools"]
---

### 第一阶段：智能体的基石

在构建智能体的初期，我们需要搭建起最基础的互动框架。这一阶段包含了前三个关键机制：

#### s01：智能体循环 (The Agent Loop)

> **箴言：** _"One loop & Bash is all you need"（一个循环和 Bash 就是你所需要的全部）_ [5]。

这是智能体的最底层架构。它证明了一个最简可行产品（MVP）的诞生：只需要“一个工具 + 一个循环”就能构成一个具备基础执行能力的智能体 [5]。这个循环不断地获取模型输出、执行系统指令并将结果返回给模型。

#### s02：工具使用 (Tool Use)

> **箴言：** _"Adding a tool means adding one handler"（添加一个工具意味着添加一个处理器）_ [5]。

随着智能体需要完成更多样化的任务，我们需要为其配备工具。这一步的精妙之处在于，**核心循环保持不变** [5]。任何新增加的工具，只需注册到调度映射表（dispatch map）中即可 [5]。这种解耦设计使得扩展智能体的能力变得异常简单。

#### s03：待办写入 (TodoWrite)

> **箴言：** _"An agent without a plan drifts"（没有计划的智能体只会随波逐流）_ [5]。

在拥有了工具之后，如果不加约束，模型可能会陷入漫无目的的尝试。因此，引入了 TodoWrite 机制。通过要求智能体在实际执行之前先列出步骤（list the steps first, then execute），可以使其任务完成率翻倍 [5]。这赋予了智能体“先思考、后行动”的规划能力。
